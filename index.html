<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fence Installer Academy</title>
  <meta name="description" content="Fence Installer Academy ‚Äî Learn cedar, vinyl, and chain link fences. Business roadmap included." />
  <style>
    :root{
      --bg:#0b1220; --card:#111a2e; --card2:#0e1730; --text:#e8eefc; --muted:#a9b6d6;
      --accent:#4aa3ff; --accent2:#27d3a2; --danger:#ff5b6e; --border:rgba(255,255,255,.08);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius:16px;
      --max: 980px;
      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{ box-sizing:border-box; }
    body{
      margin:0; font-family:var(--font); background: radial-gradient(1200px 800px at 20% 0%, rgba(74,163,255,.18), transparent 55%),
      radial-gradient(900px 700px at 90% 10%, rgba(39,211,162,.14), transparent 60%),
      var(--bg);
      color:var(--text);
    }
    a{ color:inherit; text-decoration:none; }
    .wrap{ max-width:var(--max); margin:0 auto; padding:18px; padding-bottom:90px; }
    .topbar{
      position:sticky; top:0; z-index:10; backdrop-filter: blur(10px);
      background: rgba(11,18,32,.72); border-bottom:1px solid var(--border);
    }
    .topbar-inner{ max-width:var(--max); margin:0 auto; padding:12px 18px; display:flex; gap:12px; align-items:center; justify-content:space-between; }
    .brand{ display:flex; align-items:center; gap:10px; }
    .logo{
      width:38px; height:38px; border-radius:12px;
      background: linear-gradient(135deg, rgba(74,163,255,.95), rgba(39,211,162,.95));
      box-shadow: var(--shadow);
    }
    .title{ font-weight:800; letter-spacing:.2px; }
    .subtitle{ color:var(--muted); font-size:12px; margin-top:2px; }
    .right{ display:flex; gap:10px; align-items:center; }
    .pill{
      border:1px solid var(--border); background: rgba(255,255,255,.04);
      border-radius:999px; padding:8px 10px; display:flex; gap:8px; align-items:center;
    }
    select{
      background:transparent; color:var(--text); border:0; outline:none; font-weight:700;
    }
    select option{ color:#0b1220; }
    .btn{
      border:1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      padding:10px 12px; border-radius:12px; cursor:pointer; color:var(--text); font-weight:800;
    }
    .btn.primary{ border-color: rgba(74,163,255,.35); box-shadow: 0 0 0 3px rgba(74,163,255,.12) inset; }
    .btn:active{ transform: translateY(1px); }
    .grid{ display:grid; gap:14px; }
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border:1px solid var(--border); border-radius: var(--radius);
      box-shadow: var(--shadow); padding:16px;
    }
    .hero{ padding:18px; }
    .hero h1{ margin:0; font-size:26px; line-height:1.15; letter-spacing:.2px; }
    .hero p{ margin:10px 0 0; color:var(--muted); line-height:1.5; }
    .row{ display:flex; gap:10px; flex-wrap:wrap; margin-top:14px; }
    .tag{ font-size:12px; padding:7px 10px; border-radius:999px; border:1px solid var(--border); color:var(--muted); }
    .progressbar{ margin-top:12px; height:10px; background: rgba(255,255,255,.06); border-radius:999px; overflow:hidden; border:1px solid var(--border); }
    .progressbar > div{ height:100%; width:0; background: linear-gradient(90deg, var(--accent), var(--accent2)); }
    .section-title{ margin:0 0 10px; font-size:14px; color:var(--muted); letter-spacing:.2px; font-weight:800; text-transform:uppercase; }
    .module{
      display:flex; gap:12px; align-items:flex-start; justify-content:space-between;
      padding:12px; border-radius:14px; border:1px solid var(--border);
      background: rgba(255,255,255,.03);
    }
    .module:hover{ background: rgba(255,255,255,.05); }
    .mod-left{ display:flex; gap:12px; align-items:flex-start; flex:1; min-width:0; }
    .badge{
      width:38px; height:38px; border-radius:14px; display:flex; align-items:center; justify-content:center;
      background: rgba(74,163,255,.14); border:1px solid rgba(74,163,255,.28); font-weight:900;
      flex: 0 0 auto;
    }
    .mod-title{ font-weight:900; margin:0; }
    .mod-desc{ margin:6px 0 0; color:var(--muted); font-size:13px; line-height:1.45; }
    .mod-meta{ margin-top:8px; display:flex; gap:8px; flex-wrap:wrap; }
    .mini{ font-size:12px; color:var(--muted); border:1px solid var(--border); border-radius:999px; padding:6px 8px; }
    .mod-right{ display:flex; flex-direction:column; align-items:flex-end; gap:8px; }
    .smallbtn{ font-size:12px; padding:8px 10px; border-radius:10px; }
    .ok{ color: var(--accent2); font-weight:900; }
    .danger{ color: var(--danger); font-weight:900; }
    .lessonlist{ margin-top:12px; display:grid; gap:8px; }
    .lesson{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding:10px; border-radius:12px; border:1px solid var(--border);
      background: rgba(255,255,255,.02);
    }
    .lesson .name{ font-weight:800; }
    .lesson .hint{ color:var(--muted); font-size:12px; }
    .checkbox{ width:18px; height:18px; border-radius:6px; border:1px solid var(--border); display:inline-block; }
    .checkbox.done{ background: rgba(39,211,162,.2); border-color: rgba(39,211,162,.45); }
    .footerbar{
      position:fixed; left:0; right:0; bottom:0; z-index:20;
      background: rgba(11,18,32,.82); border-top:1px solid var(--border); backdrop-filter: blur(10px);
    }
    .nav{
      max-width:var(--max); margin:0 auto; padding:10px 18px;
      display:flex; justify-content:space-between; gap:10px;
    }
    .nav a{
      flex:1; text-align:center; padding:10px 8px; border-radius:14px;
      border:1px solid transparent; color:var(--muted); font-weight:900; font-size:12px;
    }
    .nav a.active{
      color:var(--text);
      border-color: rgba(74,163,255,.3);
      background: rgba(74,163,255,.08);
    }
    .two{ display:grid; gap:14px; grid-template-columns: 1fr; }
    @media (min-width: 860px){
      .two{ grid-template-columns: 1.3fr .7fr; align-items:start; }
      .hero h1{ font-size:32px; }
    }
    .note{ color:var(--muted); font-size:13px; line-height:1.5; }
    .input{
      width:100%; padding:12px 12px; border-radius:12px;
      border:1px solid var(--border); background: rgba(255,255,255,.03); color:var(--text);
      outline:none;
    }
    .muted{ color:var(--muted); }
  </style>
</head>

<body>
  <div class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <div class="title" id="appTitle">Fence Installer Academy</div>
          <div class="subtitle" id="appSubtitle">MVP ‚Ä¢ PWA/Web ‚Ä¢ Modules 1‚Äì8</div>
        </div>
      </div>

      <div class="right">
        <div class="pill" title="Language">
          <span class="muted" style="font-weight:900;">üåê</span>
          <select id="lang">
            <option value="en">EN</option>
            <option value="es">ES</option>
            <option value="ru">RU</option>
          </select>
        </div>
        <button class="btn primary" id="resetBtn" type="button">Reset</button>
      </div>
    </div>
  </div>

  <div class="wrap">
    <div id="view"></div>
  </div>

  <div class="footerbar">
    <div class="nav">
      <a href="#home" id="navHome">Home</a>
      <a href="#course" id="navCourse">Course</a>
      <a href="#progress" id="navProgress">Progress</a>
      <a href="#profile" id="navProfile">Profile</a>
    </div>
  </div>

<script>
  // ======= CONTENT (edit this later) =======
  const CONTENT = {
    en: {
      appSubtitle: "MVP ‚Ä¢ PWA/Web ‚Ä¢ Modules 1‚Äì8",
      home: {
        h1: "Become a Professional Fence Installer",
        p: "This is your course MVP. Next we‚Äôll add photos, diagrams, videos, and deeper lessons. For now: clean structure + multilingual content + progress tracking.",
        tags: ["Cedar", "Vinyl", "Chain Link", "Repairs", "Business Roadmap"],
        cta: "Continue learning"
      },
      course: { title: "Course Modules", search: "Search modules or lessons..." },
      progress: { title: "Progress", note: "Progress is saved on this device (localStorage). Later we‚Äôll add accounts & sync." },
      profile: { title: "Profile", note: "In MVP: language + local progress. Later: login, payments, certificates." },
      buttons: { open: "Open", lessons: "Lessons", markAll: "Mark all", clearAll: "Clear", back: "Back" },
      labels: { completed: "Completed", total: "Total", module: "Module", lesson: "Lesson" }
    },
    es: {
      appSubtitle: "MVP ‚Ä¢ PWA/Web ‚Ä¢ M√≥dulos 1‚Äì8",
      home: {
        h1: "Convi√©rtete en un instalador profesional de cercas",
        p: "Este es el MVP del curso. Despu√©s agregaremos fotos, diagramas, videos y lecciones m√°s profundas. Por ahora: estructura + 3 idiomas + progreso.",
        tags: ["Cercas de cedro", "Vinilo", "Malla cicl√≥nica", "Reparaciones", "Negocio"],
        cta: "Continuar"
      },
      course: { title: "M√≥dulos del curso", search: "Buscar m√≥dulos o lecciones..." },
      progress: { title: "Progreso", note: "El progreso se guarda en este dispositivo. Luego agregaremos cuentas y sincronizaci√≥n." },
      profile: { title: "Perfil", note: "En MVP: idioma + progreso local. Luego: login, pagos, certificados." },
      buttons: { open: "Abrir", lessons: "Lecciones", markAll: "Marcar todo", clearAll: "Borrar", back: "Atr√°s" },
      labels: { completed: "Completado", total: "Total", module: "M√≥dulo", lesson: "Lecci√≥n" }
    },
    ru: {
      appSubtitle: "MVP ‚Ä¢ PWA/–≤–µ–± ‚Ä¢ –ú–æ–¥—É–ª–∏ 1‚Äì8",
      home: {
        h1: "–°—Ç–∞–Ω—å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–æ–º –∑–∞–±–æ—Ä–æ–≤",
        p: "–≠—Ç–æ MVP –∫—É—Ä—Å–∞. –ü–æ–∑–∂–µ –¥–æ–±–∞–≤–∏–º —Ñ–æ—Ç–æ, —Å—Ö–µ–º—ã, –≤–∏–¥–µ–æ –∏ –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–∏–µ —É—Ä–æ–∫–∏. –°–µ–π—á–∞—Å: —á–∏—Å—Ç–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ + 3 —è–∑—ã–∫–∞ + —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.",
        tags: ["–ö–µ–¥—Ä", "–í–∏–Ω–∏–ª", "–ß–µ–π–Ω –ª–∏–Ω–∫", "–†–µ–º–æ–Ω—Ç—ã", "–ë–∏–∑–Ω–µ—Å-–¥–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞"],
        cta: "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ"
      },
      course: { title: "–ú–æ–¥—É–ª–∏ –∫—É—Ä—Å–∞", search: "–ü–æ–∏—Å–∫ –ø–æ –º–æ–¥—É–ª—è–º –∏–ª–∏ —É—Ä–æ–∫–∞–º..." },
      progress: { title: "–ü—Ä–æ–≥—Ä–µ—Å—Å", note: "–ü—Ä–æ–≥—Ä–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ. –ü–æ–∑–∂–µ –¥–æ–±–∞–≤–∏–º –∞–∫–∫–∞—É–Ω—Ç—ã –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é." },
      profile: { title: "–ü—Ä–æ—Ñ–∏–ª—å", note: "–í MVP: —è–∑—ã–∫ + –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å. –ü–æ–∑–∂–µ: –ª–æ–≥–∏–Ω, –æ–ø–ª–∞—Ç—ã, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã." },
      buttons: { open: "–û—Ç–∫—Ä—ã—Ç—å", lessons: "–£—Ä–æ–∫–∏", markAll: "–û—Ç–º–µ—Ç–∏—Ç—å –≤—Å—ë", clearAll: "–°–±—Ä–æ—Å–∏—Ç—å", back: "–ù–∞–∑–∞–¥" },
      labels: { completed: "–ì–æ—Ç–æ–≤–æ", total: "–í—Å–µ–≥–æ", module: "–ú–æ–¥—É–ª—å", lesson: "–£—Ä–æ–∫" }
    }
  };

  // Modules + lesson stubs (you will ‚Äúpolish‚Äù these later)
  const MODULES = [
    {
      id: "m1",
      title: { en: "Safety & Jobsite Basics", es: "Seguridad y obra", ru: "–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –æ–±—ä–µ–∫—Ç" },
      desc:  { en: "PPE, common injuries, tools safety, basic first aid, risk mindset.", es:"PPE, lesiones comunes, seguridad de herramientas, primeros auxilios.", ru:"PPE, —Ç—Ä–∞–≤–º—ã, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞, –ø–µ—Ä–≤–∞—è –ø–æ–º–æ—â—å, –º—ã—à–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞." },
      lessons: [
        { id:"1", t:{en:"What a pro installer is", es:"Qu√© es un profesional", ru:"–ö—Ç–æ —Ç–∞–∫–æ–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª"} },
        { id:"2", t:{en:"PPE & joint protection", es:"PPE y protecci√≥n de articulaciones", ru:"PPE –∏ –∑–∞—â–∏—Ç–∞ —Å—É—Å—Ç–∞–≤–æ–≤"} },
        { id:"3", t:{en:"Tool safety & electricity", es:"Seguridad de herramientas y electricidad", ru:"–ó–∞—â–∏—Ç–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –∏ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ"} },
        { id:"4", t:{en:"Digging: impact load injuries", es:"Excavar: lesiones por impacto", ru:"–ö–æ–ø–∫–∞: —É–¥–∞—Ä–Ω—ã–µ —Ç—Ä–∞–≤–º—ã"} },
        { id:"5", t:{en:"Utilities basics & careful digging", es:"Servicios subterr√°neos", ru:"–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –∏ –æ—Å—Ç–æ—Ä–æ–∂–Ω–∞—è –∫–æ–ø–∫–∞"} },
        { id:"6", t:{en:"First aid kit overview", es:"Botiqu√≠n b√°sico", ru:"–ê–ø—Ç–µ—á–∫–∞ –∏ –ø–µ—Ä–≤–∞—è –ø–æ–º–æ—â—å"} },
      ]
    },
    {
      id: "m2",
      title: { en: "Tools & Materials", es: "Herramientas y materiales", ru: "–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã" },
      desc:  { en: "Must-have tools, repair kit, fast concrete, hardware, BOM with buffer.", es:"Herramientas clave, reparaciones, concreto r√°pido, herrajes, BOM con –∑–∞–ø–∞—Å.", ru:"–ù–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞, —Ä–µ–º–æ–Ω—Ç—ã, fast concrete, –∫—Ä–µ–ø—ë–∂, BOM —Å –∑–∞–ø–∞—Å–æ–º." },
      lessons: [
        { id:"1", t:{en:"Fence types overview", es:"Tipos de cercas", ru:"–¢–∏–ø—ã –∑–∞–±–æ—Ä–æ–≤"} },
        { id:"2", t:{en:"Must-have tool list", es:"Lista de herramientas", ru:"–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä"} },
        { id:"3", t:{en:"Repair tools kit", es:"Kit de reparaci√≥n", ru:"–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ä–µ–º–æ–Ω—Ç–∞"} },
        { id:"4", t:{en:"Hardware: galvanized vs stainless", es:"Herrajes", ru:"–ö—Ä–µ–ø—ë–∂"} },
        { id:"5", t:{en:"Posts: wood, steel, pipe insert", es:"Postes", ru:"–°—Ç–æ–ª–±—ã: –¥–µ—Ä–µ–≤–æ/–º–µ—Ç–∞–ª–ª/–Ω–∞ —Ç—Ä—É–±–µ"} },
        { id:"6", t:{en:"Concrete types (fast for repairs)", es:"Tipos de concreto", ru:"–ë–µ—Ç–æ–Ω (fast –¥–ª—è —Ä–µ–º–æ–Ω—Ç–æ–≤)"} },
      ]
    },
    {
      id: "m3",
      title: { en: "Measurement, Layout & Planning", es:"Medici√≥n y planificaci√≥n", ru:"–ó–∞–º–µ—Ä—ã –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ" },
      desc:  { en:"Onsite estimate, slope, boundaries, line layout, gate planning.", es:"Estimaci√≥n, pendientes, l√≠mites, l√≠nea, puertas.", ru:"–ó–∞–º–µ—Ä, —É–∫–ª–æ–Ω—ã, –≥—Ä–∞–Ω–∏—Ü—ã, —Ä–∞–∑–º–µ—Ç–∫–∞, –≤–æ—Ä–æ—Ç–∞." },
      lessons: [
        { id:"1", t:{en:"Client questions at estimate", es:"Preguntas al cliente", ru:"–í–æ–ø—Ä–æ—Å—ã –Ω–∞ –∑–∞–º–µ—Ä–µ"} },
        { id:"2", t:{en:"Measure lengths & corners", es:"Medir longitudes", ru:"–î–ª–∏–Ω—ã –∏ —É–≥–ª—ã"} },
        { id:"3", t:{en:"Slope planning", es:"Pendientes", ru:"–£–∫–ª–æ–Ω—ã"} },
        { id:"4", t:{en:"Boundary basics & risk note", es:"L√≠mites y riesgo", ru:"–ì—Ä–∞–Ω–∏—Ü—ã –∏ —Ä–∏—Å–∫–∏"} },
        { id:"5", t:{en:"String line layout", es:"L√≠nea con cuerda", ru:"–®–Ω—É—Ä–∫–∞ –∏ —Ä–∞–∑–º–µ—Ç–∫–∞"} },
        { id:"6", t:{en:"Gate planning first", es:"Planificar puertas", ru:"–í–æ—Ä–æ—Ç–∞ –ø–ª–∞–Ω–∏—Ä—É—é—Ç—Å—è –ø–µ—Ä–≤—ã–º–∏"} },
      ]
    },
    {
      id: "m4",
      title: { en:"Cedar Fences", es:"Cercas de cedro", ru:"–ö–µ–¥—Ä–æ–≤—ã–µ –∑–∞–±–æ—Ä—ã" },
      desc:  { en:"Estate vs Full Panel, posts 24 in holes, concrete strategy, gates block.", es:"Estate vs panel, postes, concreto, puertas.", ru:"Estate vs Full Panel, —è–º—ã 24\", –±–µ—Ç–æ–Ω, –≤–æ—Ä–æ—Ç–∞." },
      lessons: [
        { id:"1", t:{en:"Estate vs Full Panel (slope –Ω—é–∞–Ω—Å—ã)", es:"Estate vs Panel", ru:"Estate vs Full Panel (—É–∫–ª–æ–Ω—ã)"} },
        { id:"2", t:{en:"Demo: keep or remove old concrete", es:"Demolici√≥n y concreto", ru:"–î–µ–º–æ–Ω—Ç–∞–∂ –∏ —Å—Ç–∞—Ä—ã–π –±–µ—Ç–æ–Ω"} },
        { id:"3", t:{en:"Digging 24 in & roots (multitool)", es:"Excavar 24\" y ra√≠ces", ru:"–ö–æ–ø–∫–∞ 24\" –∏ –∫–æ—Ä–Ω–∏"} },
        { id:"4", t:{en:"Posts: pipe insert height 2‚Äì2.5 in", es:"Poste con tubo", ru:"–°—Ç–æ–ª–± –Ω–∞ —Ç—Ä—É–±–µ 2‚Äì2.5\""} },
        { id:"5", t:{en:"Rails attachment options", es:"Opciones de riel", ru:"–î–≤–∞ —Å–ø–æ—Å–æ–±–∞ –∫—Ä–µ–ø–ª–µ–Ω–∏—è —Ä–µ–ª—å—Å"} },
        { id:"6", t:{en:"Gates block (planning & reinforcement)", es:"Puertas", ru:"–í–æ—Ä–æ—Ç–∞ (–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É—Å–∏–ª–µ–Ω–∏–µ)"} },
      ]
    },
    {
      id: "m5",
      title: { en:"Chain Link", es:"Malla cicl√≥nica", ru:"–ß–µ–π–Ω –ª–∏–Ω–∫" },
      desc:  { en:"Geometry + tension. Terminal posts, ties, gates, vinyl-coated tips.", es:"Geometr√≠a y tensi√≥n.", ru:"–ì–µ–æ–º–µ—Ç—Ä–∏—è –∏ –Ω–∞—Ç—è–∂–µ–Ω–∏–µ." },
      lessons: [
        { id:"1", t:{en:"Components & terms", es:"Componentes", ru:"–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã"} },
        { id:"2", t:{en:"Terminal posts first", es:"Postes terminales", ru:"–¢–µ—Ä–º–∏–Ω–∞–ª—å–Ω—ã–µ —Å—Ç–æ–ª–±—ã"} },
        { id:"3", t:{en:"Line posts & top rail", es:"Postes de l√≠nea", ru:"–õ–∏–Ω–µ–π–Ω—ã–µ —Å—Ç–æ–ª–±—ã –∏ top rail"} },
        { id:"4", t:{en:"Fabric tension sequence", es:"Tensado", ru:"–ü–æ—Ä—è–¥–æ–∫ –Ω–∞—Ç—è–∂–µ–Ω–∏—è"} },
        { id:"5", t:{en:"Gates for chain link", es:"Puertas", ru:"–í–æ—Ä–æ—Ç–∞"} },
      ]
    },
    {
      id: "m6",
      title: { en:"Vinyl Fences", es:"Cercas de vinilo", ru:"–í–∏–Ω–∏–ª" },
      desc:  { en:"System installation, temperature expansion, precision, reinforced gates.", es:"Sistema, expansi√≥n, precisi√≥n.", ru:"–°–∏—Å—Ç–µ–º–∞, —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ, —Ç–æ—á–Ω–æ—Å—Ç—å." },
      lessons: [
        { id:"1", t:{en:"Vinyl is a system", es:"Vinilo = sistema", ru:"–í–∏–Ω–∏–ª = —Å–∏—Å—Ç–µ–º–∞"} },
        { id:"2", t:{en:"Posts & spacing precision", es:"Postes y distancia", ru:"–°—Ç–æ–ª–±—ã –∏ —à–∞–≥"} },
        { id:"3", t:{en:"Temperature expansion", es:"Expansi√≥n t√©rmica", ru:"–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–µ –ø–æ–¥–≤–∏–∂–∫–∏"} },
        { id:"4", t:{en:"Vinyl gates reinforcement", es:"Refuerzo de puertas", ru:"–£—Å–∏–ª–µ–Ω–∏–µ –≤–æ—Ä–æ—Ç"} },
      ]
    },
    {
      id: "m7",
      title: { en:"Repairs", es:"Reparaciones", ru:"–†–µ–º–æ–Ω—Ç—ã" },
      desc:  { en:"Diagnosis, post replacement (remove concrete ideally), rot protection, disposal.", es:"Diagn√≥stico, postes, protecci√≥n.", ru:"–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞, —Å—Ç–æ–ª–±—ã, –∑–∞—â–∏—Ç–∞, —É—Ç–∏–ª–∏–∑–∞—Ü–∏—è." },
      lessons: [
        { id:"1", t:{en:"Repair vs replace decision", es:"Reparar o reemplazar", ru:"–†–µ–º–æ–Ω—Ç –∏–ª–∏ –∑–∞–º–µ–Ω–∞"} },
        { id:"2", t:{en:"Post replacement priority", es:"Reemplazo de poste", ru:"–ó–∞–º–µ–Ω–∞ —Å—Ç–æ–ª–±–∞"} },
        { id:"3", t:{en:"Concrete removal methods", es:"Quitar concreto", ru:"–£–¥–∞–ª–µ–Ω–∏–µ –±–µ—Ç–æ–Ω–∞"} },
        { id:"4", t:{en:"Rot protection (tape / concrete above grade)", es:"Protecci√≥n contra pudrici√≥n", ru:"–ó–∞—â–∏—Ç–∞ –æ—Ç –≥–Ω–∏–µ–Ω–∏—è (—Ç–µ–π–ø/–±–µ—Ç–æ–Ω –≤—ã—à–µ –∑–µ–º–ª–∏)"} },
      ]
    },
    {
      id: "m8",
      title: { en:"Business & Pricing Roadmap", es:"Negocio y precios", ru:"–ë–∏–∑–Ω–µ—Å –∏ —Ü–µ–Ω—ã" },
      desc:  { en:"Pricing logic, estimates, deposits, marketing basics, 8-week roadmap.", es:"Precios, estimados, marketing.", ru:"–¶–µ–Ω–∞, —Å–º–µ—Ç—ã, –¥–µ–ø–æ–∑–∏—Ç—ã, –º–∞—Ä–∫–µ—Ç–∏–Ω–≥, –ø–ª–∞–Ω 8 –Ω–µ–¥–µ–ª—å." },
      lessons: [
        { id:"1", t:{en:"Owner mindset", es:"Mentalidad de due√±o", ru:"–ú—ã—à–ª–µ–Ω–∏–µ –≤–ª–∞–¥–µ–ª—å—Ü–∞"} },
        { id:"2", t:{en:"Pricing formula & add-ons", es:"F√≥rmula de precios", ru:"–§–æ—Ä–º—É–ª–∞ —Ü–µ–Ω—ã –∏ –¥–æ–ø—ã"} },
        { id:"3", t:{en:"Estimate ‚Üí contract ‚Üí deposit", es:"Contrato y dep√≥sito", ru:"–°–º–µ—Ç–∞ ‚Üí –∫–æ–Ω—Ç—Ä–∞–∫—Ç ‚Üí –¥–µ–ø–æ–∑–∏—Ç"} },
        { id:"4", t:{en:"Marketing channels overview", es:"Marketing", ru:"–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥"} },
        { id:"5", t:{en:"8-week roadmap", es:"Plan de 8 semanas", ru:"–î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ 8 –Ω–µ–¥–µ–ª—å"} },
      ]
    }
  ];

  // ======= APP STATE =======
  const LS_KEY = "fia_progress_v1";
  const LS_LANG = "fia_lang_v1";

  function loadProgress(){
    try { return JSON.parse(localStorage.getItem(LS_KEY) || "{}"); }
    catch { return {}; }
  }
  function saveProgress(p){ localStorage.setItem(LS_KEY, JSON.stringify(p)); }
  function loadLang(){
    return localStorage.getItem(LS_LANG) || "en";
  }
  function saveLang(l){ localStorage.setItem(LS_LANG, l); }

  function t(path){
    const lang = state.lang;
    const parts = path.split(".");
    let cur = CONTENT[lang];
    for(const k of parts){ cur = cur?.[k]; }
    return cur ?? path;
  }

  function moduleTitle(m){ return m.title[state.lang] || m.title.en; }
  function moduleDesc(m){ return m.desc[state.lang] || m.desc.en; }
  function lessonTitle(m, lesson){ return lesson.t[state.lang] || lesson.t.en; }

  function totalLessons(){
    return MODULES.reduce((acc,m)=>acc + m.lessons.length, 0);
  }
  function completedLessons(progress){
    let c=0;
    for(const m of MODULES){
      for(const l of m.lessons){
        if(progress?.[m.id]?.[l.id] === true) c++;
      }
    }
    return c;
  }

  function setActiveNav(route){
    ["Home","Course","Progress","Profile"].forEach(k=>{
      const el = document.getElementById("nav"+k);
      if(!el) return;
      el.classList.toggle("active", route === k.toLowerCase());
    });
  }

  const state = {
    lang: loadLang(),
    progress: loadProgress(),
    route: "home",
    selectedModuleId: null,
    search: ""
  };

  // ======= RENDER =======
  function render(){
    document.getElementById("lang").value = state.lang;
    document.getElementById("appSubtitle").textContent = CONTENT[state.lang].appSubtitle;

    const hash = (location.hash || "#home").replace("#","");
const parts = hash.split("/");
const route = parts[0];
state.route = route || "home";
state.selectedModuleId = (route === "module" || route === "lesson") ? parts[1] : null;
state.selectedLessonId = (route === "lesson") ? parts[2] : null;

    setActiveNav(state.route);

    const view = document.getElementById("view");
    view.innerHTML = "";

    if(state.route === "home") view.appendChild(renderHome());
    else if(state.route === "course") view.appendChild(renderCourse());
    else if(state.route === "module" && state.selectedModuleId) view.appendChild(renderModule(state.selectedModuleId));
    else if(state.route === "progress") view.appendChild(renderProgress());
    else if(state.route === "profile") view.appendChild(renderProfile());
    else { location.hash = "#home"; }
  }

  function el(tag, attrs={}, children=[]){
    const n = document.createElement(tag);
    for(const [k,v] of Object.entries(attrs)){
      if(k === "class") n.className = v;
      else if(k.startsWith("on") && typeof v === "function") n.addEventListener(k.substring(2), v);
      else if(k === "html") n.innerHTML = v;
      else n.setAttribute(k, v);
    }
    for(const c of children){
      if(typeof c === "string") n.appendChild(document.createTextNode(c));
      else if(c) n.appendChild(c);
    }
    return n;
  }

  function renderHome(){
    const done = completedLessons(state.progress);
    const total = totalLessons();
    const pct = total ? Math.round((done/total)*100) : 0;

    const left = el("div", {class:"card hero"}, [
      el("h1", {}, [t("home.h1")]),
      el("p", {}, [t("home.p")]),
      el("div", {class:"row"}, CONTENT[state.lang].home.tags.map(x => el("span",{class:"tag"},[x]))),
      el("div", {class:"progressbar", title:"Progress"}, [
        el("div", {style:`width:${pct}%`})
      ]),
      el("div", {class:"row"}, [
        el("span",{class:"mini"},[`${t("labels.completed")}: ${done}`]),
        el("span",{class:"mini"},[`${t("labels.total")}: ${total}`]),
        el("span",{class:"mini"},[`${pct}%`]),
      ]),
      el("div", {class:"row"}, [
        el("button", {class:"btn primary", onclick:()=>{ location.hash="#course"; }}, [t("home.cta")])
      ])
    ]);

    const right = el("div",{class:"card"},[
      el("div",{class:"section-title"},["Next step"]),
      el("div",{class:"note"},[
        "1) Open Course ‚Üí 2) Choose a module ‚Üí 3) Mark lessons as completed. ",
        "Tomorrow you can start ‚Äúpolishing‚Äù texts, and later we‚Äôll add photos + diagrams."
      ])
    ]);

    const wrap = el("div",{class:"two"},[left,right]);
    return wrap;
  }

  function renderCourse(){
    const container = el("div", {class:"grid"}, [
      el("div",{class:"card"},[
        el("div",{class:"section-title"},[t("course.title")]),
        el("input",{class:"input", placeholder:t("course.search"), value:state.search, oninput:(e)=>{ state.search=e.target.value; render(); }})
      ])
    ]);

    const q = (state.search || "").trim().toLowerCase();
    const modulesFiltered = MODULES.filter(m=>{
      if(!q) return true;
      const inTitle = (m.title.en+" "+m.title.es+" "+m.title.ru).toLowerCase().includes(q);
      const inDesc  = (m.desc.en+" "+m.desc.es+" "+m.desc.ru).toLowerCase().includes(q);
      const inLessons = m.lessons.some(l => (l.t.en+" "+l.t.es+" "+l.t.ru).toLowerCase().includes(q));
      return inTitle || inDesc || inLessons;
    });

    const list = el("div",{class:"card"},[
      el("div",{class:"section-title"},[t("course.title")])
    ]);

    modulesFiltered.forEach((m, idx)=>{
      const done = Object.values(state.progress?.[m.id] || {}).filter(Boolean).length;
      const total = m.lessons.length;
      const pct = total ? Math.round((done/total)*100) : 0;

      list.appendChild(
        el("div",{class:"module"},[
          el("div",{class:"mod-left"},[
            el("div",{class:"badge"},[String(idx+1)]),
            el("div",{style:"min-width:0;"},[
              el("p",{class:"mod-title"},[`${t("labels.module")} ${idx+1}: ${moduleTitle(m)}`]),
              el("p",{class:"mod-desc"},[moduleDesc(m)]),
              el("div",{class:"mod-meta"},[
                el("span",{class:"mini"},[`${t("labels.completed")}: ${done}/${total}`]),
                el("span",{class:"mini"},[`${pct}%`]),
              ])
            ])
          ]),
          el("div",{class:"mod-right"},[
            el("button",{class:"btn smallbtn primary", onclick:()=>{ location.hash = "#module/"+m.id; }},[t("buttons.open")]),
          ])
        ])
      );
    });

    container.appendChild(list);
    return container;
  }

  function renderModule(moduleId){
    const m = MODULES.find(x=>x.id===moduleId);
    if(!m) return el("div",{class:"card"},["Module not found"]);

    const idx = MODULES.findIndex(x=>x.id===moduleId) + 1;
    const mp = state.progress[m.id] || {};
    const done = Object.values(mp).filter(Boolean).length;
    const total = m.lessons.length;
    const pct = total ? Math.round((done/total)*100) : 0;

    const head = el("div",{class:"card"},[
      el("div",{class:"row", style:"justify-content:space-between; align-items:center;"},[
        el("div",{},[
          el("div",{class:"section-title"},[`${t("labels.module")} ${idx}`]),
          el("h2",{style:"margin:6px 0 0; font-size:22px;"},[moduleTitle(m)]),
          el("p",{class:"note", style:"margin:10px 0 0;"},[moduleDesc(m)]),
        ]),
        el("button",{class:"btn", onclick:()=>{ location.hash="#course"; }},[t("buttons.back")])
      ]),
      el("div",{class:"progressbar"},[ el("div",{style:`width:${pct}%`}) ]),
      el("div",{class:"row"},[
        el("span",{class:"mini"},[`${t("labels.completed")}: ${done}/${total}`]),
        el("span",{class:"mini"},[`${pct}%`]),
        el("button",{class:"btn smallbtn", onclick:()=>{ markAll(m.id,true); }},[t("buttons.markAll")]),
        el("button",{class:"btn smallbtn", onclick:()=>{ markAll(m.id,false); }},[t("buttons.clearAll")]),
      ])
    ]);

    const lessons = el("div",{class:"card"},[
      el("div",{class:"section-title"},[t("buttons.lessons")]),
      el("div",{class:"lessonlist"}, m.lessons.map((l, i)=>{
        const isDone = state.progress?.[m.id]?.[l.id] === true;
        return el("div",{class:"lesson", onclick:()=>{ toggleLesson(m.id, l.id); }},[
          el("div",{},[
            el("div",{class:"name"},[`${t("labels.lesson")} ${idx}.${i+1}: ${lessonTitle(m,l)}`]),
            el("div",{class:"hint"},[isDone ? "‚úì done" : "tap to mark complete"])
          ]),
          el("span",{class:"checkbox"+(isDone?" done":"")},[])
        ]);
      }))
    ]);

    return el("div",{class:"grid"},[head, lessons]);
  }

  function renderProgress(){
    const done = completedLessons(state.progress);
    const total = totalLessons();
    const pct = total ? Math.round((done/total)*100) : 0;

    const perModule = MODULES.map((m, idx)=>{
      const d = Object.values(state.progress?.[m.id]||{}).filter(Boolean).length;
      const tcount = m.lessons.length;
      const p = tcount ? Math.round((d/tcount)*100) : 0;
      return { idx: idx+1, id:m.id, title: moduleTitle(m), done:d, total:tcount, pct:p };
    });

    const card = el("div",{class:"card"},[
      el("div",{class:"section-title"},[t("progress.title")]),
      el("p",{class:"note"},[t("progress.note")]),
      el("div",{class:"progressbar"},[ el("div",{style:`width:${pct}%`}) ]),
      el("div",{class:"row"},[
        el("span",{class:"mini"},[`${t("labels.completed")}: ${done}`]),
        el("span",{class:"mini"},[`${t("labels.total")}: ${total}`]),
        el("span",{class:"mini"},[`${pct}%`]),
      ]),
      el("div",{style:"margin-top:12px; display:grid; gap:8px;"}, perModule.map(pm =>
        el("div",{class:"module"},[
          el("div",{class:"mod-left"},[
            el("div",{class:"badge"},[String(pm.idx)]),
            el("div",{style:"min-width:0;"},[
              el("p",{class:"mod-title"},[pm.title]),
              el("p",{class:"mod-desc"},[`${pm.done}/${pm.total} ‚Ä¢ ${pm.pct}%`]),
            ])
          ]),
          el("div",{class:"mod-right"},[
            el("button",{class:"btn smallbtn primary", onclick:()=>{ location.hash="#module/"+pm.id; }},[t("buttons.open")]),
          ])
        ])
      ))
    ]);

    return el("div",{class:"grid"},[card]);
  }

  function renderProfile(){
    const card = el("div",{class:"card"},[
      el("div",{class:"section-title"},[t("profile.title")]),
      el("p",{class:"note"},[t("profile.note")]),
      el("div",{class:"row"},[
        el("span",{class:"mini"},["Plan: MVP (local progress)"]),
        el("span",{class:"mini"},["Next: Login + Stripe + Admin"]),
        el("span",{class:"mini"},["Next: Photos/Diagrams/Videos"]),
      ]),
      el("p",{class:"note", style:"margin-top:12px;"},[
        "Tip: tomorrow you can edit module/lesson texts inside this file. ",
        "Later we‚Äôll move content into separate JSON files and build a real admin panel."
      ])
    ]);
    return el("div",{class:"grid"},[card]);
  }

  // ======= ACTIONS =======
  function toggleLesson(mid, lid){
    state.progress[mid] = state.progress[mid] || {};
    state.progress[mid][lid] = !(state.progress[mid][lid] === true);
    saveProgress(state.progress);
    render();
  }
  function markAll(mid, value){
    const m = MODULES.find(x=>x.id===mid);
    if(!m) return;
    state.progress[mid] = state.progress[mid] || {};
    for(const l of m.lessons){ state.progress[mid][l.id] = value; }
    saveProgress(state.progress);
    render();
  }

  // ======= INIT =======
  document.getElementById("lang").addEventListener("change", (e)=>{
    state.lang = e.target.value;
    saveLang(state.lang);
    render();
  });

  document.getElementById("resetBtn").addEventListener("click", ()=>{
    if(!confirm("Reset local progress on this device?")) return;
    state.progress = {};
    saveProgress(state.progress);
    render();
  });

  // load saved lang
  state.lang = loadLang();
  document.getElementById("lang").value = state.lang;

  window.addEventListener("hashchange", render);
  render();
</script>
</body>
</html>
